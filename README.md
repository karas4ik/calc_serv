## Описание проекта

Этот проект представляет собой арифметический калькулятор, который использует веб-сервер для приема и обработки математических выражений. Он позволяет пользователям отправлять арифметические выражения, которые затем вычисляются, и результаты сохраняются для последующего запроса. Оч короч круто

Проект состоит из двух основных компонентов:
- Оркестратор: Обрабатывает запросы, парсит выражения и управляет их вычислением.
- Агент: Получает задачи от оркестратора и выполняет вычисления.

## Как использовать проект

### Запуск сервера

1. Убедитесь, что у вас установлен [Go](https://golang.org/dl/).

2. Клонируйте репозиторий проекта:

```bash
   git clone https://github.com/karas4ik/calc_serv
```

3. Перейдите в папку cmd/orchestrator и запустите оркестратор:

```bash
   go run main.go
```

4. В другой консоли перейдите в папку cmd/agent и запустите агента:

```bash
   go run main.go
```

### Использование веб-части

После запуска серверов вы можете отправлять запросы на вычисление выражений.

#### Пример использования

1. Отправка арифметического выражения для вычисления с помощью POST-запроса.
2. Получение результата вычисления с помощью GET-запроса.

## Примеры запросов

### 1. Запрос на вычисление выражения (POST)

```bash
URL: /api/v1/calculate  
```

Метод: POST  

Заголовок: Content-Type: application/json  

Тело запроса:

```bash
{
  "expression": "4 + 4 - 4 * 4"
}
```

Ответ:

```bash
{
  "id": "some-id"
}
```

### 2. Запрос на получение списка всех выражений (GET)

```bash
URL: /api/v1/expressions  
```

Метод: GET  

Ответ:

```bash
{
  "expressions": [
    {
      "id": "some-id",
      "status": "completed",
      "result": -8
    }
  ]
}
```

### 3. Запрос на получение результата по ID (GET)

```bash
URL: /api/v1/expressions/{id}  
```

Метод: GET  

Пример запроса:

```bash
GET /api/v1/expressions/some-id
```

Ответ:

```bash
{
  "expression": {
    "id": "some-id",
    "status": "completed",
    "result": -8
  }
}
```

### Еще примеры работы

#### Пример 4: Запрос на вычисление выражения с делением

```bash
URL: /api/v1/calculate  
```

Метод: POST  

Тело запроса:

```bash
{
  "expression": "10 / 2 + 3"
}
```

Ответ:

```bash
{
  "id": "another-id"
}
```

Получение результата:

```bash
GET /api/v1/expressions/another-id
```

Ответ:

```bash
{
  "expression": {
    "id": "another-id",
    "status": "completed",
    "result": 8
  }
}
```

#### Пример 5: Запрос на вычисление выражения с несколькими операциями

```bash
URL: /api/v1/calculate  
```

Метод: POST  

Тело запроса:

```bash
{
  "expression": "5 + 2 * 3 - 4 / 2"
}
```

Ответ:

```bash
{
  "id": "third-id"
}
```

Получение результата:

```bash
GET /api/v1/expressions/third-id
```

Ответ:

```bash
{
  "expression": {
    "id": "third-id",
    "status": "completed",
    "result": 10
  }
}
```

#### Пример 6: Запрос на вычисление выражения с делением на ноль

```bash
URL: /api/v1/calculate  
```

Метод: POST  

Тело запроса:

```bash
{
  "expression": "4 / 0"
}
```

Ответ:

```bash
{
  "error": "division by zero"
}
```

## Для теста 

### Пример 1: Запрос на вычисление выражения

Запрос на вычисление выражения (POST)

```bash
curl --location 'http://localhost:5000/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
  "expression": "10 + 5 - 3 * 2"
}'
```

Ожидаемый ответ:

```json
{
  "id": "какой-то тут айди мутный"
}
```

Получение результата по ID

```bash
curl --location 'http://localhost:5000/api/v1/expressions/какой-то тут айди мутный'
```
Ожидаемый ответ:

```json
{
  "expression": {
    "id": "какой-то тут айди мутный",
    "status": "completed",
    "result": 9
  }
}
```

### Пример 2: Запрос на вычисление выражения с делением

Запрос на вычисление выражения (POST)

```bash
curl --location 'http://localhost:5000/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
  "expression": "20 / 4 + 3"
}'
```

Ожидаемый ответ:

```json
{
  "id": "какой-то тут айди мутный 2 "
}
```

Получение результата по ID

```bash
curl --location 'http://localhost:5000/api/v1/expressions/какой-то тут айди мутный 2'
```

Ожидаемый ответ:

```json
{
  "expression": {
    "id": "какой-то тут айди мутный 2 ",
    "status": "completed",
    "result": 8
  }
}
```
### Пример 3: Запрос на вычисление выражения с делением на ноль

Запрос на вычисление выражения (POST)

```bash
curl --location 'http://localhost:5000/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
  "expression": "5 / 0"
}'
```

Ожидаемый ответ:

```json
{
  "expression": {
    "id": "ответика нету(",
    "status": "completed"
  }
}
```

### Пример 5: Запрос на вычисление с использованием всех операций

Запрос на вычисление выражения (POST)

```bash
curl --location 'http://localhost:5000/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
  "expression": "10 + 2 * 5 - 3 / 1"
}'
```

Ожидаемый ответ:

```json
{
  "id": "какой-то тут айди мутный 3"
}
```

Получение результата по ID

```bash
curl --location 'http://localhost:5000/api/v1/expressions/какой-то тут айди мутный 3'
```

Ожидаемый ответ:

```json
{
  "expression": {
    "id": "some-id-4",
    "status": "completed",
    "result": 17
  }
}
```

## Возможности 

### Таблица 1: Возможности API

| Метод | URL                        | Описание                                       |
|-------|----------------------------|------------------------------------------------|
| POST  | /api/v1/calculate       | Отправка арифметического выражения для вычисления |
| GET   | /api/v1/expressions     | Получение списка всех вычисленных выражений   |
| GET   | /api/v1/expressions/{id}| Получение результата по ID выражения           |

### Таблица 2: Формат запросов и ответов

| Метод | Запрос                                                      | Ответ                                                |
|-------|------------------------------------------------------------|-----------------------------------------------------|
| POST  | {"expression": "4 + 4 - 4 * 4"}                          | {"id": "some-id"}                                |
| GET   | [{ "expressions": [ { "id": "some-id", "status": "completed", "result": -8 } ] }] | [{ "expression": { "id": "some-id", "status": "completed", "result": -8 }}] |

### Таблица 3: Возможные ошибки

| Код ошибки | Описание                                      |
|------------|-----------------------------------------------|
| 400        | Неверный запрос (например, отсутствует выражение) |
| 422        | Невозможно вычислить выражение (например, из-за деления на ноль) |
| 404        | Не найдено выражение по указанному ID        |

## Короч как это робит

```plaintext
                 +--------------------+
                 |   Пользователь      |
                 +--------------------+
                            |
                            | Отправляет POST-запрос
                            v
                 +--------------------+
                 |   Оркестратор       |
                 |  (Обработка запросов)|
                 +--------------------+
                            |
                            | Парсит выражение
                            | Создает задачу
                            v
                 +--------------------+
                 |       Задачи        |
                 +--------------------+
                            |
                            | Передает задачу
                            v
                 +--------------------+
                 |       Агент        |
                 |  (Выполнение задач) |
                 +--------------------+
                            |
                            | Возвращает результат
                            v
                 +--------------------+
                 |   Оркестратор       |
                 +--------------------+
                            |
                            | Сохраняет результат
                            v
                 +--------------------+
                 |   Пользователь      |
                 +--------------------+
                            |
                            | Отправляет GET-запрос
                            v
                 +--------------------+
                 |   Оркестратор       |
                 +--------------------+
                            |
                            | Отправляет результат
                            v
                 +--------------------+
                 |   Пользователь      |
                 +--------------------+
```

